<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Turnos del Consultorio</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>

  <body class="bg-verde">
    <div class="container py-5">
      <!-- Logo + TÃ­tulo -->
      <div class="text-center mb-4">
        <h1 class="titulo-consultorio d-flex align-items-center justify-content-center">
          <img
            src="img/logo3.jpeg"
            alt="Logo Consultorio"
            class="logo-consultorio me-2"
          />
       
        </h1>
      </div>

      <!-- Formulario -->
      <div class="card shadow p-4 mb-5">
        <h4 class="mb-3">Registrar nuevo turno</h4>
        <form id="formTurno" class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Nombre del Paciente</label>
            <input
              type="text"
              id="nombre"
              class="form-control"
              placeholder="Ej: Juan PÃ©rez"
              required
            />
          </div>

          <div class="col-md-3">
            <label class="form-label">Fecha</label>
            <input type="date" id="fecha" class="form-control" required />
          </div>

          <div class="col-md-3">
            <label class="form-label">Hora</label>
            <select id="hora" class="form-select" required>
              <option value="">Seleccionar...</option>
              <option>09:00</option>
              <option>10:00</option>
              <option>11:00</option>
              <option>12:00</option>
              <option>14:00</option>
              <option>15:00</option>
              <option>16:00</option>
            </select>
          </div>

          <!-- Cards de servicios -->
          <div class="col-12 mt-4">
            <label class="form-label d-block mb-3">Seleccionar servicio</label>
            <div
              id="servicios"
              class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3 justify-content-center"
            >
              <!-- Cards creadas dinÃ¡micamente -->
            </div>
          </div>

          <div class="col-12 text-center mt-4">
            <button type="submit" class="btn btn-primary px-5">
              Guardar Turno
            </button>
          </div>
        </form>
      </div>

      <!-- Lista de turnos -->
      <div class="card shadow p-4">
        <h4 class="mb-3">ðŸ“‹ Turnos Aceptados</h4>
        <ul id="listaTurnos" class="list-group"></ul>
        <button id="borrarTodo" class="btn btn-danger mt-3 w-100">
          Borrar todos los turnos
        </button>
      </div>

      <!-- BotÃ³n del historial -->
      <div class="text-center mt-5">
        <button
          class="btn btn-outline-primary px-4"
          data-bs-toggle="modal"
          data-bs-target="#modalHistorial"
        >
          ðŸ“… Ver historial de turnos finalizados
        </button>
      </div>
    </div>

    <!-- Modal del historial -->
    <div
      class="modal fade"
      id="modalHistorial"
      tabindex="-1"
      aria-labelledby="modalHistorialLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg rounded-4">
          <div class="modal-header bg-primary text-white rounded-top-4">
            <h5 class="modal-title" id="modalHistorialLabel">
              Historial de turnos finalizados
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Cerrar"
            ></button>
          </div>
          <div class="modal-body">
            <!-- Filtro por fecha -->
           

            <!-- Filtro por fecha -->
<!-- Filtro por fecha -->
<div class="mb-3 d-flex align-items-center gap-2 justify-content-center flex-wrap">
  <div>
    <label for="filtroFechaHistorial" class="form-label fw-semibold mb-1 d-block text-center">
      Filtrar por fecha
    </label>
    <input type="date" id="filtroFechaHistorial" class="form-control" style="max-width: 220px" />
  </div>
  <button id="limpiarFiltro" class="btn btn-outline-secondary mt-4">Limpiar filtro</button>
</div>

<ul id="historialTurnos" class="list-group mt-3 mb-4"></ul>



            <!-- Lista de historial -->
            <ul id="historialTurnos" class="list-group"></ul>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-outline-secondary"
              data-bs-dismiss="modal"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    getDocs,
    deleteDoc,
    doc,
    updateDoc,
    onSnapshot   // âœ… Agregado para activar actualizaciones en tiempo real
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyANnN6Ose--VKrEilbuseekzJ9W7q1A-WY",
    authDomain: "herabeauty-a9a32.firebaseapp.com",
    projectId: "herabeauty-a9a32",
    storageBucket: "herabeauty-a9a32.appspot.com",
    messagingSenderId: "533992137681",
    appId: "1:533992137681:web:efde6b6f8096db21fa36f0",
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Exponer globalmente las funciones (incluyendo onSnapshot)
  window.db = db;
  window.firestoreFns = { collection, addDoc, getDocs, deleteDoc, doc, updateDoc, onSnapshot };

  console.log("âœ… Firebase conectado correctamente");
</script>



    <!-- Script principal -->
    <script src="script.js" defer></script>
  </body>
</html>
